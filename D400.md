# $D400-$D41C

## 54272-54273 $D400-$D401 FRELO1 FREHI1 <a name="D400"></a>
### Frequency control registers
The value in this pair of registers determines the frequency of
the sound generated for voice 1. The higher the frequency, the
higher the pitch of the sound. For triangle, sawtooth, and
pulse waveforms, the relationship between the value in these
registers and the voice 1 sound frequency in hertz (cycles per
second) is:

<pre>
frequency = register value * clock rate / 16777216
</pre>

The first register (54272/$D400) holds the low byte of the
value and the second (54273/$D401) holds the high byte. The
clock rate depends on which video system the 128 uses. For
NTSC (North American) systems, the clock value is 1022730
Hz, while for PAL (European) systems it is 985250 Hz. Thus,
you can use the following expressions to calculate the frequency
produced by any given register setting:

<pre>
frequency = register value * 0.06096 (for NTSC systems)
frequency = register value * 0.05873 (for PAL systems)
</pre>

Since the register pair can hold values from 0-65535/
$0000-$FFFF, the range of possible output frequencies for an
NTSC system is 0-3995 Hz. A register value of zero corresponds
to no frequency, hence no sound. The upper limit of
human hearing is about 20,000 Hz, but the fact that the SID
can't generate frequencies above 4000 Hz isn't really a serious
handicap. The frequencies between 4000 and 20,000 Hz are
not often used in music. For example, the highest note on a
piano (a C four octaves above middle C) has a frequency of
4186 Hz, just slightly beyond the SID's range. The SID can
produce notes corresponding to those for any of the 88 keys
on a piano keyboard except the very rightmost one. The lower
limit of human hearing is about 20 Hz, so register values less
than about 320/$0140 should result in inaudible output regardless
of the volume setting. Actually, this is true only for
the triangle waveform. The sudden transitions in output amplitude
during sawtooth and pulse waveforms will produce a
clicking or buzzing output at these supposedly inaudible low
frequencies.

If you know the frequency (in hertz) that you wish to
generate, you can calculate the corresponding register setting
using the following formulae:

<pre>
register value = desired frequency * 16.40 (for NTSC systems)
register value = desired frequency * 17.03 (for PAL systems)
</pre>

It is permissible to change the frequency of a sound
while it is playing. The change will take effect immediately,
and will not affect the envelope. Changing the frequency of an
active sound can produce interesting effects. See the entry for
the register at [54299/$D41B](#D41B) for an example.

The noise waveform doesn't have a regularly repeating
pattern like the triangle, sawtooth, and pulse waveforms. The
output jumps erratically from one amplitude level to another,
so noise doesn't really have a frequency in the same sense
that the other waveforms do. For noise, the value in these registers
determines how rapidly the amplitude level changes.
The number of changes per second is approximately equal to
the register value. For example, a register value of 1000/$03E8
will cause the noise output level to change about 1000 times
per second, or approximately one change every 1/1000 second. The
faster the output level changes, the higher the perceived pitch
of the generated noise.
Remember that these are write-only registers; they will always
return 0/$00 when read, regardless of the values you
have stored in them.

## 54274-54275 $D402-$D403 PWLO1 PWHI1 <a name="D402"></a>
### Pulsewidth control registers
This register pair controls the waveform shape when pulse
output is selected for voice 1. The value here has no effect on
any other waveform. The pulse waveform is binary; that is, it
has two states: maximum amplitude and off ({)no amplitude).
Unlike the ideal sine waveform, which has a smooth transition
between maximum and minimum amplitudes, the pulse waveform switches
almost instantly. The duration of each cycle of
the waveform is controlled by the registers at 54272-54273/
$D400-$D401. What the registers here control is how much of
each cycle the waveform spends in the zero-amplitude state.
Pulse waveforms are often described in terms of their duty
cycles, the percentage of the total waveform cycle spent in the
maximum amplitude state. A pulse waveform with a 0-percent
duty cycle is always off, while a pulse waveform with a 100-
percent duty cycle is always at maximum amplitude. A waveform with
a 50-percent duty cycle is at maximum amplitude
for half of the cycle and off for the remaining half, resulting in
a square wave. Next figure illustrates various duty cycles.

![Pulse Waveform Duty Cycles](resources/008-11-f-pulse-waveform-duty-cycles.png)

This register pair controls the duty cycle (expressed as a
percentage of the total duration of one cycle of the waveform)
according to the following formula:
<pre>
duty cycle = 100 - (register value / 40.95)
</pre>

Only 12 of the 16 bits in the register pair are used. The lower
8 bits come from the register at 54274/$D402 and the higher
4 bits come from bits 0-3 of the register at 54275/$D403. Bits
4-7 of 54275/$D403 are unused; any value written to these
bits has no effect. The available 12 bits allow register values of
0-4095/$000-$EFF, Thus, you can specify duty cycles in the
full range 0-100 percent. If you know the duty cycle you
want, you can calculate the proper register value with:
register value = (100 - desired duty cycle) * 40.95
In the expression above, the duty cycle is expressed as a
percentage. For example, the required register value for a 50-percent
duty cycle-a square wave-would be (100 - 50) * 40.95 =
2048/$0800. For this, you would store the low byte (0/$00) in
54274/$D402 and the high byte (8/$08) in 54275/$D403.
There's one phemomenon you need to be aware of when
selecting duty cycles. The relative percentage of the pulse
waveform cycle spent in each state, rather than the actual
state, determines how the resulting output will sound. Notice
in figure that both the 25-percent and 75-percent duty
cycles have waveforms that are in one state for 25 percent of
the cycle and the other state for 75 percent of the cycle. In
either case, the ratio of time spent in each state is 3 to 1. A
pulse wave with a 75-percent duty cycle will sound exactly
the same as one with a 25-percent duty cycle. For every pulse
waveform duty cycle less than 50 percent, there is a duty cycle
greater than 50 percent that will produce the same sound. For
example, a waveform with a 10-percent duty cycle (on for 10
percent of the cycle and off for the remaining 90 percent) will
sound the same as a waveform with a 90-percent duty cycle
(on for 90 percent of the cycle and off for the remaining 10
percent), since for either waveform the cycle is divided between
the two states in a 9-to-1 ratio.

The closer the register value is to 2048/$0800-the value
for a square wave (50-percent duty cycle, 1-to-1 ratio of time
in each state)-the richer the resulting output will sound. As
the register value approaches 4095 or 0, for 0- or 100-percent
duty cycles, respectively, the ratio approaches its maximum of
1 to 4095 and the resulting sound output becomes increasingly
thin. Very low or very high duty cycles result in nearly inaudible
output. Duty cycles of exactly 0 or 100 percent result in
constant output levels. Since some variation in the output is
required to produce sound, register values of 0/$000 or 4095/
$FFFF produce no audible output.
It is permissible to change the value in these registers, and
hence the width of a pulse waveform, while the voice is generating
output. This will affect only the waveform, not the envelope.
Remember that these are write-only registers; they will
always return 0/$00 when read, regardless of the values you
have stored in them.
